(function(e){function t(t){for(var n,i,u=t[0],o=t[1],c=t[2],h=0,p=[];h<u.length;h++)i=u[h],a[i]&&p.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);l&&l(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,u=1;u<r.length;u++){var o=r[u];0!==a[o]&&(n=!1)}n&&(s.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},a={app:0},s=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],o=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var l=o;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"56d7":function(e,t,r){"use strict";r.r(t);r("7f7f"),r("96cf");var n=r("3b8d"),a=(r("cadf"),r("551c"),r("f751"),r("097d"),r("baf5"),r("2b0e")),s=r("8c4f"),i=r("5f5b"),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("b-container",[r("b-navbar",{attrs:{toggleable:"md"}},[r("b-navbar-brand",{attrs:{to:"/"}},[r("img",{staticStyle:{height:"100px"},attrs:{src:"/static/img/logo_transparent.png",alt:"Linn's TV Search"}})]),r("b-navbar-toggle",{attrs:{target:"mainNav"}},[r("img",{attrs:{src:"/static/img/hamburger_icon.svg"}})]),r("b-collapse",{attrs:{"is-nav":"",id:"mainNav"}},[r("b-navbar-nav",[r("b-nav-item",{attrs:{to:"about"}},[e._v("About Us")]),r("b-nav-item",{staticClass:"nav-github-link",attrs:{href:"https://github.com/SimplyLinn/tvmaze-api-frontend"}},[r("img",{staticClass:"icon",attrs:{src:"/static/img/GitHub-Mark.png"}}),e._v(" Github")])],1)],1)],1),r("router-view")],1)],1)},o=[],c={name:"app"},l=c,h=r("2877"),p=Object(h["a"])(l,u,o,!1,null,null,null),m=p.exports,f=(r("9607"),r("8e6e"),r("ac6a"),r("456d"),r("bd86")),d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-row",[r("b-form-input",{staticClass:"searchForm",attrs:{autocomplete:"off",placeholder:"Search for series"},on:{input:e.debounceInput,focus:e.onfocus},model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}}),r("div",{staticClass:"searchResContainer"},[r("keep-alive",[e.hasFocus?r("search-results",{attrs:{searchQuery:e.searchQuery,searching:e.searching}}):e._e()],1)],1),r("router-view")],1)},b=[],g=(r("386d"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-container",{staticClass:"searchbox"},[e.searchQuery.term.length>=3?[r("b-row",{staticStyle:{"margin-bottom":"5px"}},[r("b-col",[e._v("Showing "+e._s(e.searchQuery.results.length+" result"+(1===e.searchQuery.results.length?"":"s"))+" for "),r("b",[e._v(e._s(e.searchQuery.term))]),e._v(" (query took "+e._s(e.searchQuery.time)+"ms)")])],1),r("result-list",{attrs:{results:e.searchQuery.results}})]:r("b-row",[e._v("\n    Type at least 3 characters to search.\n  ")]),e.searching?r("div",{staticClass:"searchBlur"}):e._e()],2)}),w=[],v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.results.length?r("div",[e._l(e.results,function(t,n){var a=t.result;return[r("result-entry",{key:a.id,attrs:{result:a}}),n<e.results.length-1?r("hr",{key:a.id+"hr"}):e._e()]})],2):r("div",[e._v("\n  NO RESULTS TO SHOW!\n")])},y=[],_=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-row",{staticClass:"resultEntry",on:{click:e.clicked}},[r("b-col",{attrs:{cols:"3",sm:"2"}},[r("result-img",{staticStyle:{width:"100%"},attrs:{result:e.result}})],1),r("b-col",{attrs:{cols:"9",sm:"10"}},[e.result.premiered?[r("b-badge",[e._v(e._s(e.result.premiered.substring(0,4)))]),e._v(" ")]:e._e(),e.result.type?[r("b-badge",[e._v(e._s(e.result.type))]),e._v(" ")]:e._e(),e.result.status?[r("b-badge",{attrs:{variant:e.statusVariant}},[e._v(e._s(e.result.status))]),e._v(" ")]:e._e(),r("h5",[e._v(e._s(e.result.name)+" "),e.result.genres?[e._l(e.result.genres,function(t){return[r("b-badge",{key:e.result.id+t},[e._v(e._s(t))]),e._v(" ")]})]:e._e()],2),r("br"),r("span",[e._v(e._s(e.summaryText))])],2)],1)},k=[],x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("img",{attrs:{src:e.src,alt:e.result.name}})},O=[],j={name:"app",data:function(){return{src:"/static/img/logo_transparent.png"}},props:{result:Object},methods:{loadImage:function(e){var t=this;e=e||this.result,e.thumbUrl?e.thumb?this.src=URL.createObjectURL(e.thumb):fetch(e.thumbUrl).then(function(r){r.blob().then(function(r){t.src=URL.createObjectURL(r),e.thumb=r,e.save()})}):this.src="/static/img/GitHub-Mark.png"}},mounted:function(){this.loadImage()},watch:{result:function(e){this.loadImage(e)}}},S=j,U=Object(h["a"])(S,x,O,!1,null,null,null),P=U.exports,R=(r("a481"),r("75fc")),E=(r("28a5"),r("5df3"),r("4f7f"),r("d225")),C=r("308d"),T=r("6bb5"),W=r("4e2b"),D=r("f28b"),I=function(e){function t(){var e;return Object(E["a"])(this,t),e=Object(C["a"])(this,Object(T["a"])(t).call(this,"The search was cancelled.")),e.name=e.constructor.name,e}return Object(W["a"])(t,e),t}(Object(D["a"])(Error)),Q=function(e){function t(){var e;return Object(E["a"])(this,t),e=Object(C["a"])(this,Object(T["a"])(t).call(this,"The resource was not found.")),e.name=e.constructor.name,e}return Object(W["a"])(t,e),t}(Object(D["a"])(Error));function $(e){return new Promise(function(t){return setTimeout(t,e)})}function F(){return(new Date).getTime()}function L(e){var t=new Set;return e.toLowerCase().split(" ").forEach(function(e){return e&&t.add(e)}),Object(R["a"])(t)}function q(e,t,r,n){return N.apply(this,arguments)}function N(){return N=Object(n["a"])(regeneratorRuntime.mark(function e(t,r,n,a){var s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=n||20,s=[],i=0;case 3:if(!(i<t.length)){e.next=13;break}if(0===i||i%n!==0){e.next=9;break}return e.next=7,$(1);case 7:if(!a.isCancelled){e.next=9;break}throw new I;case 9:s.push(r(t[i],i,t));case 10:i++,e.next=3;break;case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}},e)})),N.apply(this,arguments)}function M(e){var t=""+e;return t=t.replace(/<br>/gi,"\n"),t=t.replace(/<br\s\/>/gi,"\n"),t=t.replace(/<br\/>/gi,"\n"),t=t.replace(/<p.*?>/gi,"\n"),t=t.replace(/<a.*href="(.*?)".*>(.*?)<\/a>/gi," $2 ($1)"),t=t.replace(/<script.*>[\w\W]{1,}(.*?)[\w\W]{1,}<\/script>/gi,""),t=t.replace(/<style.*>[\w\W]{1,}(.*?)[\w\W]{1,}<\/style>/gi,""),t=t.replace(/<(?:.|\s)*?>/g,""),t=t.replace(/(?:(?:\r\n|\r|\n)\s*){2,}/gim,"\n\n"),t=t.replace(/ +(?= )/g,""),t=t.replace(/&nbsp;/gi," "),t=t.replace(/&amp;/gi,"&"),t=t.replace(/&quot;/gi,'"'),t=t.replace(/&lt;/gi,"<"),t=t.replace(/&gt;/gi,">"),t}var H=new a["default"],A=350,B={name:"app",data:function(){return{}},components:{"result-img":P},props:{result:Object},computed:{summaryText:function(){var e=M(this.result.summary);return e.length<A?e:e.substring(0,A-3)+"..."},statusVariant:function(){switch(this.result.status.toLowerCase()){case"running":return"success";case"ended":return"danger";case"in development":return"warning";default:return null}}},methods:{clicked:function(){H.$emit("closeSearch"),this.$router.push({name:"show",params:{id:this.result.id}})}}},V=B,z=Object(h["a"])(V,_,k,!1,null,null,null),K=z.exports,G={name:"app",data:function(){return{filterOpen:!1}},components:{"result-entry":K},props:{results:Array},computed:{sanitizedSummary:{get:function(){return sanitizeHtml(this.result.summary)}}},methods:{}},J=G,X=Object(h["a"])(J,v,y,!1,null,null,null),Y=X.exports,Z={name:"app",data:function(){return{filterOpen:!1}},components:{"result-list":Y},props:{searchQuery:Object,searching:Boolean},methods:{}},ee=Z,te=Object(h["a"])(ee,g,w,!1,null,null,null),re=te.exports,ne=(r("7514"),r("55dd"),r("6762"),r("2fdb"),r("c5f6"),r("04ff"),r("b0b4")),ae=(r("7cdf"),r("7618")),se=r("bc3a"),ie=r.n(se);function ue(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ue(r,!0).forEach(function(t){Object(f["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var ce=2e3,le=ie.a.create({baseURL:"https://api.tvmaze.com/",timeout:5e3}),he=[],pe=!1,me=function(){function e(){Object(E["a"])(this,e)}return Object(ne["a"])(e,[{key:"doRequest",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=0;case 1:return e.prev=2,e.next=5,le.request(t);case 5:return e.abrupt("return",e.sent);case 8:if(e.prev=8,e.t0=e["catch"](2),e.t0.isAxiosError){e.next=12;break}throw e.t0;case 12:if(e.t0.response){e.next=14;break}throw e.t0;case 14:if(429===e.t0.response.status){e.next=16;break}throw e.t0;case 16:if(n=Math.min(10*ce,Math.round(ce*Math.pow(1.5,r))),r++,!(this.maxRetries&&r>=this.maxRetries)){e.next=20;break}throw e.t0;case 20:return console.log("We got ratelimited, waiting ".concat(n,"ms. We have tried ").concat(r," times.")),e.next=23,$(n);case 23:e.next=1;break;case 25:case"end":return e.stop()}},e,this,[[2,8]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"runQueue",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t,r,n,a,s=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(pe=!0,he.length){e.next=4;break}return pe=!1,e.abrupt("return");case 4:t=he.pop(),r=t.config,n=t.resolve,a=t.reject,this.doRequest(r).then(n).catch(a).finally(function(){return s.runQueue()});case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"request",value:function(e){var t=this,r=!1;return e.hasOwnProperty("priority")&&(r=e.priority,delete e.priority),new Promise(function(n,a){he[r?"push":"unshift"]({config:e,resolve:n,reject:a}),pe||t.runQueue()})}},{key:"get",value:function(e,t){return this.request(oe({url:e,method:"get"},t||{}))}},{key:"delete",value:function(e,t){return this.request(oe({url:e,method:"delete"},t||{}))}},{key:"head",value:function(e,t){return this.request(oe({url:e,method:"head"},t||{}))}},{key:"options",value:function(e,t){return this.request(oe({url:e,method:"options"},t||{}))}},{key:"post",value:function(e,t,r){return this.request(oe({url:e,method:"post",data:t},r||{}))}},{key:"put",value:function(e,t,r){return this.request(oe({url:e,method:"put",data:t},r||{}))}},{key:"patch",value:function(e,t,r){return this.request(oe({url:e,method:"patch",data:t},r||{}))}},{key:"getUri",value:function(e){le.getUri(e)}},{key:"getShowsPage",value:function(e){if(e=e||0,"number"!==typeof e)throw new TypeError("Invalid type, expected number, got ".concat(Object(ae["a"])(e)));if(!Number.isInteger(e)||e<0)throw new RangeError("Invalid value, expected positive integer");return this.get("shows?page=".concat(e))}},{key:"getEpisodes",value:function(e){return this.get("shows/".concat(1*e,"/episodes"))}}]),e}(),fe=new me,de=(r("f559"),r("74ce")),be=new de["a"]("ShowsDatabase");be.version(7).stores({shows:"id,*nameWords"}),be.shows.hook("creating",function(e,t,r){"string"===typeof t.name&&(t.nameWords=L(t.name)),"string"===typeof t.thumbUrl&&t.thumbUrl.startsWith("http:")&&(t.thumbUrl="https"+t.thumbUrl.substring(4)),"string"===typeof t.imageUrl&&t.imageUrl.startsWith("http:")&&(t.imageUrl="https"+t.imageUrl.substring(4))}),be.shows.hook("updating",function(e,t,r,n){var a={};return e.hasOwnProperty("name")&&("string"==typeof e.name?a.nameWords=L(e.name):a.nameWords=[]),e.hasOwnProperty("thumbUrl")&&"string"===typeof r.thumbUrl&&r.thumbUrl.startsWith("http:")&&(a.thumbUrl="https"+r.thumbUrl.substring(4)),e.hasOwnProperty("imageUrl")&&"string"===typeof r.imageUrl&&r.imageUrl.startsWith("http:")&&(a.imageUrl="https"+r.imageUrl.substring(4)),a});var ge=be.shows.defineClass({id:Number,name:String,nameWords:[String],updated:Number,thumb:Blob,thumbUrl:String,imageUrl:String,type:String,summary:String,genres:[String],episodes:[{name:String,season:Number,number:Number,summary:String,thumb:null,thumbUrl:String,imageUrl:String}],episodesFetched:Date});ge.prototype.save=function(){return be.shows.put(this)};var we=be,ve=r("0430"),ye=r.n(ve);window.db=we;var _e=864e5,ke=250,xe=function(){function e(){Object(E["a"])(this,e);var t=localStorage.getItem("lastUpdated")||"0",r=Number.parseInt(t);this._lastUpdated=new Date(r>0?r:0),F()-this.lastUpdated.getTime()>_e?this.refreshShows():this.getNewShows()}return Object(ne["a"])(e,[{key:"searchTypingFirstWord",value:function(e){return we.shows.where("nameWords").startsWithIgnoreCase(e).distinct().toArray()}},{key:"searchPromises",value:function(e,t){return we.transaction("r","shows",Object(n["a"])(regeneratorRuntime.mark(function r(){var n,a,s;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Promise.all(e);case 2:if(n=r.sent,!t||!t.isCancelled){r.next=5;break}throw new I;case 5:if(n.length){r.next=7;break}return r.abrupt("return",[]);case 7:return a=n.reduce(function(e,t){for(var r=[],n=0;n<e.length;n++)t.includes(e[n])&&r.push(e[n]);return r}),r.next=10,we.shows.where(":id").anyOf(a).toArray();case 10:if(s=r.sent,!t||!t.isCancelled){r.next=13;break}throw new I;case 13:return r.abrupt("return",s);case 14:case"end":return r.stop()}},r)})))}},{key:"searchLastCharSpace",value:function(e,t){var r=this;return we.transaction("r","shows",function(){return r.searchPromises(e.map(function(e){return we.shows.where("nameWords").equalsIgnoreCase(e).distinct().primaryKeys()}))})}},{key:"searchTypingMultipleWords",value:function(e,t,r){var n=this;return we.transaction("r","shows",function(){return n.searchPromises([].concat(Object(R["a"])(t.map(function(e){return we.shows.where("nameWords").equalsIgnoreCase(e).distinct().primaryKeys()})),[we.shows.where("nameWords").startsWithIgnoreCase(e).distinct().primaryKeys()]),r)})}},{key:"search",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t,r){var n,a,s,i,u,o,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n={isCancelled:!1},"function"===typeof r&&r(function(){n.isCancelled=!0}),a=t.split(" "),s=a.pop(),i=L(a.join(" ")),!s||i.length){e.next=11;break}return e.next=8,this.searchTypingFirstWord(s,n);case 8:u=e.sent,e.next=24;break;case 11:if(s||!i.length){e.next=17;break}return e.next=14,this.searchLastCharSpace(i,n);case 14:u=e.sent,e.next=24;break;case 17:if(!s||!i.length){e.next=23;break}return e.next=20,this.searchTypingMultipleWords(s,i,n);case 20:u=e.sent,e.next=24;break;case 23:return e.abrupt("return",[]);case 24:return o=t.toLowerCase(),e.next=27,q(u,function(e){return{result:e,rating:ye.a.compareTwoStrings(e.name.toLowerCase(),o)}},n);case 27:if(e.t0=function(e,t){return t.rating-e.rating},c=e.sent.sort(e.t0),!n.isCancelled){e.next=31;break}throw new I;case 31:return e.abrupt("return",c);case 32:case"end":return e.stop()}},e,this)}));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"parsePage",value:function(e,t){return we.transaction("rw",we.shows,Object(n["a"])(regeneratorRuntime.mark(function r(){var n,a,s,i,u,o,c;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:return n=t*ke,a=(t+1)*ke,console.log(n,a),s=we.shows.where(":id").between(n,a),r.next=6,s.primaryKeys();case 6:i=r.sent,we.shows.bulkDelete(i.filter(function(t){return!e.find(function(e){return t===e.id})})),u=0;case 9:if(!(u<e.length)){r.next=34;break}return o=e[u],r.next=13,we.shows.get(o.id);case 13:if(r.t0=r.sent,r.t0){r.next=16;break}r.t0=new ge;case 16:if(c=r.t0,c.updated!==o.updated){r.next=19;break}return r.abrupt("continue",31);case 19:return c.id=o.id,c.name=o.name,c.updated=o.updated,c.premiered=o.premiered,c.imageUrl=o.image&&o.image.original,c.type=o.type,c.status=o.status,c.summary=o.summary,c.genres=o.genres,o.image&&o.image.medium&&c.thumbUrl!==o.image.medium&&(c.thumbUrl=o.image.medium,c.thumb=null),r.next=31,c.save();case 31:u++,r.next=9;break;case 34:case"end":return r.stop()}},r)})))}},{key:"refreshPage",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=this,e.next=4,fe.getShowsPage(t);case 4:return e.t1=e.sent.data,e.t2=t,e.next=8,e.t0.parsePage.call(e.t0,e.t1,e.t2);case 8:e.next=19;break;case 10:if(e.prev=10,e.t3=e["catch"](0),e.t3.isAxiosError){e.next=14;break}throw e.t3;case 14:if(e.t3.response){e.next=16;break}throw e.t3;case 16:if(404!==e.t3.response.status){e.next=18;break}return e.abrupt("return",!1);case 18:throw e.t3;case 19:return e.abrupt("return",!0);case 20:case"end":return e.stop()}},e,this,[[0,10]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"refreshFromId",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=t||0,r=Math.floor(t/ke);case 2:return e.next=4,this.refreshPage(r);case 4:if(!e.sent){e.next=8;break}r++,e.next=2;break;case 8:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"refreshShows",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.refreshFromId();case 2:this.lastUpdated=new Date;case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getNewShows",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,we.shows.orderBy(":id").last();case 2:return t=e.sent.id,e.next=5,this.refreshFromId(t);case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getShow",value:function(e){return we.transaction("rw","shows",Object(n["a"])(regeneratorRuntime.mark(function t(){var r,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,we.shows.get(e);case 2:if(r=t.sent,r){t.next=5;break}throw new Q;case 5:if(!(!1===navigator.onLine||r.episodesFetched&&F()-r.episodesFetched.getTime()<_e)){t.next=7;break}return t.abrupt("return",r);case 7:return t.next=9,de["a"].waitFor(fe.getEpisodes(e));case 9:return t.t0=function(e){return{name:e.name,season:e.season,number:e.number,summary:e.summary,thumb:null,thumbUrl:e.image&&e.image.medium,imageUrl:e.image&&e.image.original}},n=t.sent.data.map(t.t0),r.episodes=n,r.episodesFetched=new Date,t.next=15,r.save();case 15:return t.abrupt("return",r);case 16:case"end":return t.stop()}},t)})))}},{key:"lastUpdated",get:function(){return this._lastUpdated},set:function(e){if(!(e instanceof Date))throw new TypeError("lastUpdated needs to be a Date");localStorage.setItem("lastUpdated",e.getTime()+""),this._lastUpdated=e}}]),e}(),Oe=new xe,je=r("b012"),Se=r.n(je),Ue={name:"app",data:function(){return{hasFocus:!1,searchQuery:{term:"",results:[],time:0},searching:!1,searchTerm:"",cancelFunc:null,busHandler:null}},components:{"search-results":re},methods:{onCloseSeacrh:function(){this.hasFocus=!1},onfocus:function(){this.hasFocus=!0},onPageClick:function(e){e.target===this.$el||this.$el.contains(e.target)||(this.hasFocus=!1)},debounceInput:Se()(function(e){this.doSearch(e)},100),doSearch:function(e){var t=this;if(e=" "===e[e.length-1]?e.trim()+" ":e.trim(),this.cancelSearch&&(this.cancelSearch(),this.cancelSearch=null),e.length<3)return this.searchQuery.term=e,this.searchQuery.results=[],void(this.searchQuery.time=0);var r=F();this.searching=!0,Oe.search(e,function(e){return t.cancelSearch=e}).then(function(n){t.cancelSearch=null,t.searching=!1,t.searchQuery.term=e,t.searchQuery.results=n,t.searchQuery.time=F()-r}).catch(function(e){if(!(e instanceof I))throw t.searching=!1,e})}},mounted:function(){var e=this;document.addEventListener("click",this.onPageClick),this.busHandler=function(){return e.onCloseSeacrh()},H.$on("closeSearch",this.busHandler)},beforeDestroy:function(){document.removeEventListener("click",this.onPageClick),H.$off("closeSearch",this.busHandler),this.busHandler=null}},Pe=Ue,Re=Object(h["a"])(Pe,d,b,!1,null,null,null),Ee=Re.exports,Ce=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._v(" HI ")])},Te=[],We={},De=Object(h["a"])(We,Ce,Te,!1,null,null,null),Ie=De.exports,Qe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._v("\n  404 not found. How did this happen?\n")])},$e=[],Fe={},Le=Object(h["a"])(Fe,Qe,$e,!1,null,null,null),qe=Le.exports,Ne=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._v("\n  Search above and click on a show to view details.\n")])},Me=[],He={},Ae=Object(h["a"])(He,Ne,Me,!1,null,null,null),Be=Ae.exports,Ve=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.show?r("b-container",{staticStyle:{"margin-top":"1em"}},[r("b-row",[r("b-col",{attrs:{cols:"3",sm:"2"}},[r("result-img",{staticStyle:{width:"100%"},attrs:{result:e.show}})],1),r("b-col",{attrs:{cols:"9",sm:"10"}},[e.show.premiered?[r("b-badge",[e._v(e._s(e.show.premiered.substring(0,4)))]),e._v(" ")]:e._e(),e.show.type?[r("b-badge",[e._v(e._s(e.show.type))]),e._v(" ")]:e._e(),e.show.status?[r("b-badge",{attrs:{variant:e.statusVariant}},[e._v(e._s(e.show.status))]),e._v(" ")]:e._e(),r("h4",[e._v(e._s(e.show.name)+" "),e.show.genres?[e._l(e.show.genres,function(t){return[r("b-badge",{key:e.show.id+t},[e._v(e._s(t))]),e._v(" ")]})]:e._e()],2),r("br"),r("span",[e._v(e._s(e.summaryText))])],2)],1),r("hr"),e._l(e.seasons,function(t,n){return[t?r("b-row",{key:e.show.id+"s"+n},[r("b-col",[r("h5",[e._v("Season "+e._s(n+1))])])],1):e._e(),t?r("div",{key:e.show.id+"s"+n+"list"},[r("b-list-group",e._l(t,function(t){return r("b-list-group-item",{key:e.show.id+"s"+n+"e"+t.number,attrs:{button:""}},[e._v("S"+e._s(String(t.season).padStart(2,"0"))+"E"+e._s(String(t.number).padStart(2,"0"))+": "+e._s(t.name))])}),1)],1):e._e(),t&&n<e.seasons.length-1?r("hr",{key:e.show.id+"s"+n+"hr"}):e._e()]})],2):e._e()},ze=[],Ke={name:"app",data:function(){return{show:null}},components:{"result-img":P},props:{id:Number},computed:{summaryText:function(){var e=M(this.show.summary);return e},statusVariant:function(){switch(this.show.status.toLowerCase()){case"running":return"success";case"ended":return"danger";case"in development":return"warning";default:return null}},seasons:function(){if(!this.show.episodes)return[];var e=[];return this.show.episodes.forEach(function(t){var r=t.season-1;Array.isArray(e[r])||(e[r]=[]),e[r].push(t)}),e.forEach(function(e){return e.sort(function(e,t){return e.number-t.number})}),e}},mounted:function(){this.fetchShow(this.id)},methods:{fetchShow:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("Fetching show: ".concat(t," (").concat(Object(ae["a"])(t),")")),e.prev=1,e.next=4,Oe.getShow(t);case 4:this.show=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[1,7]])}));function t(t){return e.apply(this,arguments)}return t}()},watch:{id:function(e,t){t!==e&&this.fetchShow(e)}}},Ge=Ke,Je=Object(h["a"])(Ge,Ve,ze,!1,null,null,null),Xe=Je.exports;function Ye(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r}function Ze(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ye(r,!0).forEach(function(t){Object(f["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ye(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var et=[{path:"/about",component:Ie},{path:"/",component:Ee,children:[{name:"show",path:":id",component:Xe,props:function(e){var t=Ze({},e.params);return t.id=+t.id,t}},{path:"/",component:Be}]},{path:"*",component:qe}],tt=new s["a"]({routes:et});window.tvmc=Oe,a["default"].use(s["a"]),a["default"].use(i["a"]),a["default"].config.productionTip=!1,we.open().then(function(){console.log("db opened"),new a["default"]({router:tt,render:function(e){return e(m)},created:function(){var e=Object(n["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()}).$mount("#app")}).catch(de["a"].UpgradeError,function(e){localStorage.removeItem("lastUpdated"),window.indexedDB.databases().then(function(e){for(var t=0;t<e.length;t++)window.indexedDB.deleteDatabase(e[t].name)}).then(function(){alert("New database version, refreshing page."),location.reload()})})},9607:function(e,t,r){}});
//# sourceMappingURL=app.bea729b0.js.map